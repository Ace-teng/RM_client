# RoboMaster 自定义客户端 / Custom Client

**GitHub：** [https://github.com/Ace-teng/RM_client](https://github.com/Ace-teng/RM_client)

RoboMaster 赛事队伍自制的**多设备战术信息中枢**，用于接收赛事引擎赛事数据与机器人图传、发送赛事指令，并支持雷达/车端等局域网设备接入与战术可视化。**界面与交互采用 QtPy 开发**，队伍长期基础设施，非一次性工具。

---

## 功能概述

| 能力 | 说明 |
|------|------|
| 赛事数据接入 | 赛事引擎 MQTT（Protobuf）+ 图传 UDP（HEVC），向赛事引擎发送指令 |
| 图传显示 | HEVC 解码与渲染、图传区为中心；HUD 透视框（多目标框、标签、超时隐藏、断流自动消失） |
| 态势与状态 | 地图、机器人位置、双方血量/经济/时间、关键事件、连接状态 |
| 标定 | 标定页面（进入/退出、重试、状态四态、ArUco 引导、验收点） |
| 雷达与设备间 | 雷达站、地面机器人、自定义控制器等 LAN 接入；重连、心跳、丢包/延迟统计 |
| 诊断与联调 | 连接/数据状态、多久前更新、丢弃/超时计数、一键复制诊断；可选录包与回放 |
| 控制与扩展 | 控制面板发送赛事指令；插件机制，新功能优先以插件实现 |

**系统定位：** 分布式实时通信 + 可视化；支持多屏/多角色视图（待定）；地面机器人操作手需求见总文档 §0.5。

---

## 技术栈与规范

- **界面：** **QtPy**（QMainWindow / QGraphicsView，可切换 PyQt5/6、PySide2/6）；禁止表现层混用其他 GUI 库
- **语言：** Python 3.10+
- **通信：** MQTT（192.168.12.1:3333）、UDP 图传（3334）、Protobuf v3、局域网 UDP/TCP
- **架构：** 六层（通信 → 协议 → 数据 → 业务 → 表现 → 插件）、单一数据源（DataCenter）、单向数据流、事件总线解耦

基本功能与验收点见总文档 **§0.2 基本功能总览**；最终产品形态见 **§0.3**；规定要求与功能完整、可维护性自检见 **§12**。

---

## 项目结构（规划）

与总文档 §3 一致：

```
rm_client/
├── main.py
├── core/
│   ├── comms/      # 通信层（赛事 + 设备间）
│   ├── protocol/   # 协议层
│   ├── model/      # 数据层（DataCenter）
│   ├── service/    # 业务层
│   ├── bus/        # 事件总线
│   ├── pose/       # 坐标系与标定
│   ├── time_sync/  # 时间同步
│   └── replay/     # 录包与回放
├── ui/
│   ├── hud/        # 叠加显示
│   ├── radar/      # 态势地图
│   └── control/    # 操作面板
├── plugins/        # 插件层
├── config/
└── docs/           # 需求与架构文档
```

---

## 快速开始

```bash
# 克隆
git clone https://github.com/Ace-teng/RM_client.git
cd RM_client

# 依赖（Python 3.10+、QtPy、paho-mqtt、protobuf 等，按实际补充）
# pip install -r requirements.txt

# 运行（待实现后启用）
# python rm_client/main.py
```

**前置：** 需具备 RoboMaster 赛事通信协议文档（.proto 与 Topic 定义）；图传为 HEVC，需解码库支持。

---

## 文档

**[系统需求与架构设计](docs/CustomClient_Architecture.md)** — 唯一总文档（§0～§13），含：

- **§0** 技术选型、基本功能总览、最终产品形态、多屏/多角色（待定）、地面机器人操作手需求
- **§1～2** 引言、赛事规范、总体架构要求（MUST）
- **§3～4** 目录结构、模块职责
- **§5** 功能需求（表现层、透视框、标定、诊断、QtPy 约定、基础设施层 R-COM/R-POSE/R-BUS/R-TIME/R-DBG）
- **§6～7** 数据流规范、开发阶段 Phase 1～7
- **§8～9** 开发规范与非功能需求、交接要求
- **§10～11** 实现策略与验收、变更与排错
- **§12** 总览与自检（规定要求、功能完整、可维护性体现）
- **§13** 结论

**实现须满足总文档中 MUST 条款；** 自检与验收可对照 §12。

---

## 许可证 / License

未标注则视为队伍内部使用；对外开源时请补充 LICENSE 文件。
